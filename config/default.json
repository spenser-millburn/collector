{
  "system": {
    "id": "observability-collector",
    "version": "1.0.0",
    "log_level": "INFO"
  },
  "plugins": {
    "inputs": [
      {
        "id": "file_input",
        "type": "file",
        "config": {
          "paths": [
            "/var/log/*.log",
            "/var/log/syslog"
          ],
          "multiline": {
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}",
            "negate": true,
            "match": "after"
          }
        }
      }
    ],
    "processors": [
      {
        "id": "log_parser",
        "type": "parser",
        "config": {
          "patterns": [
            "^(?P<timestamp>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d+Z) (?P<level>[A-Z]+) (?P<message>.*)$",
            "^(?P<level>[A-Z]+)\\s+(?P<timestamp>\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})\\s+(?P<message>.*)$",
            "^(?P<message>.*)$"
          ]
        }
      },
      {
        "id": "log_filter",
        "type": "filter",
        "config": {
          "include": {
            "level": ["ERROR", "WARN", "INFO"]
          },
          "exclude": {
            "message": [".*health check.*", ".*heartbeat.*"]
          }
        }
      }
    ],
    "outputs": [
      {
        "id": "stdout_output",
        "type": "stdout",
        "config": {
          "colorize": true,
          "format": "text"
        }
      },
      {
        "id": "file_output",
        "type": "file",
        "config": {
          "output_dir": "/var/log/collector",
          "rotate_interval": "1h",
          "filename_pattern": "${batch_type}-%Y%m%d-%H.log"
        }
      }
    ]
  },
  "pipelines": {
    "logs": {
      "inputs": ["file_input"],
      "processors": ["log_parser", "log_filter"],
      "outputs": ["stdout_output", "file_output"]
    },
    "metrics": {
      "inputs": [],
      "processors": [],
      "outputs": ["stdout_output"]
    }
  },
  "buffer": {
    "max_size": 1000,
    "flush_interval": "1s"
  }
}